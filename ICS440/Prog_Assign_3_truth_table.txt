Truth Table...

    end()    netEmpty()  packets   
    called   called      in queue  
 ----------------------------------
 |    0     |    0     |    0     |  (C)
 ----------------------------------
 |    0     |    0     |    1     |  (Invalid)
 ----------------------------------
 |    0     |    1     |    0     |  (C)
 ----------------------------------
 |    0     |    1     |    1     |  (A)
 ----------------------------------
 |    1     |    0     |    0     |  (C)
 ----------------------------------
 |    1     |    0     |    1     |  (Invalid)
 ----------------------------------
 |    1     |    1     |    0     |  (B)
 ----------------------------------
 |    1     |    1     |    1     |  (A)
 ----------------------------------

In the run() method:
  A - process packet
  B - return (no more packets && end() called)
  C - wait for more work